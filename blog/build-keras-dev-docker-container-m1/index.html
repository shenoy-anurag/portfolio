<!DOCTYPE html><html lang="en"><head><meta charSet="utf-8"/><meta http-equiv="x-ua-compatible" content="ie=edge"/><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"/><meta name="theme-color" content="#663399"/><meta data-react-helmet="true" name="twitter:description" content="My personal website"/><meta data-react-helmet="true" name="twitter:title" content="Building Keras-Dev Docker Container on arm64/aarch64 systems like M1 Macbooks | Anurag Shenoy&#x27;s Blog"/><meta data-react-helmet="true" name="twitter:creator" content="Anurag Shenoy"/><meta data-react-helmet="true" name="twitter:card" content="summary"/><meta data-react-helmet="true" property="og:type" content="website"/><meta data-react-helmet="true" property="og:description" content="My personal website"/><meta data-react-helmet="true" property="og:title" content="Building Keras-Dev Docker Container on arm64/aarch64 systems like M1 Macbooks | Anurag Shenoy&#x27;s Blog"/><meta data-react-helmet="true" name="description" content="My personal website"/><meta name="generator" content="Gatsby 4.12.1"/><style data-href="/styles.00bbf464be3b3b2f46f6.css" data-identity="gatsby-global-css">@import url(https://fonts.googleapis.com/css2?family=Montserrat:wght@400;700&family=Open+Sans&display=swap);@import url(https://fonts.googleapis.com/css2?family=Anonymous+Pro&display=swap);@import url(https://fonts.googleapis.com/css2?family=Inter:wght@400;700&display=swap);code[class*=language-],pre[class*=language-]{word-wrap:normal;background:none;color:#ccc;font-family:Consolas,Monaco,Andale Mono,Ubuntu Mono,monospace;font-size:1em;-webkit-hyphens:none;-ms-hyphens:none;hyphens:none;line-height:1.5;-o-tab-size:4;tab-size:4;text-align:left;white-space:pre;word-break:normal;word-spacing:normal}pre[class*=language-]{margin:.5em 0;overflow:auto;padding:1em}:not(pre)>code[class*=language-],pre[class*=language-]{background:#2d2d2d}:not(pre)>code[class*=language-]{padding:.1em}.token.block-comment,.token.cdata,.token.comment,.token.doctype,.token.prolog{color:#999}.token.punctuation{color:#ccc}.token.attr-name,.token.deleted,.token.namespace,.token.tag{color:#e2777a}.token.function-name{color:#6196cc}.token.boolean,.token.function,.token.number{color:#f08d49}.token.class-name,.token.constant,.token.property,.token.symbol{color:#f8c555}.token.atrule,.token.builtin,.token.important,.token.keyword,.token.selector{color:#cc99cd}.token.attr-value,.token.char,.token.regex,.token.string,.token.variable{color:#7ec699}.token.entity,.token.operator,.token.url{color:#67cdcc}.token.bold,.token.important{font-weight:700}.token.italic{font-style:italic}.token.entity{cursor:help}.token.inserted{color:green}.card{align-items:center;background-position:50%;background-repeat:no-repeat;background-size:cover;display:flex;height:250px;justify-content:center;overflow:hidden!important;width:100%}.card .content{cursor:pointer;font-family:Open Sans;opacity:0;padding:10px;text-align:center;-webkit-transform:translateY(20px);transform:translateY(20px);transition:all .5s ease-in-out}.card .content h1{color:#fff;font-size:28px}.card .content p{color:#fff;font-size:16px;margin-bottom:20px}.card .content .btn{background-color:#000;color:#fff;padding:10px;text-decoration:none}.card .content:hover{opacity:1;-webkit-transform:translate(0);transform:translate(0)}.navbar-wrapper{align-items:center;display:flex;justify-content:space-between;margin-top:10vh;width:80vw}.navbar-wrapper .name{font-weight:600}.navbar-wrapper .home{background-color:transparent;border:0;cursor:pointer;font-family:Open Sans;outline:none;padding:10px;text-decoration:none}.navbar-wrapper .active{color:#000}.navbar-wrapper .links-wrapper button{background-color:transparent;border:0;cursor:pointer;font-family:Open Sans;font-size:12px;opacity:.6;outline:none;padding:10px;text-decoration:none;transition:all .2s ease-in-out}.navbar-wrapper .links-wrapper button:hover{opacity:1}.navbar-wrapper .links-wrapper .link{background-color:transparent;border:0;cursor:pointer;font-family:Open Sans;font-size:12px;opacity:.6;outline:none;padding:10px;text-decoration:none;transition:all .2s ease-in-out}.navbar-wrapper .links-wrapper .link:hover{opacity:1}.navbar-wrapper .links-wrapper .active{color:#000}.header-wrapper{align-items:center;display:flex;flex-direction:column;margin-top:10vh;width:80vw}.header-wrapper h2{font-size:1rem;text-align:center}@media (min-width:320px) and (max-width:424px){.header-wrapper h2{font-size:14px}}@media (min-width:425px) and (max-width:767px){.header-wrapper h2{font-size:16px}}@media (min-width:768px) and (max-width:1023px){.header-wrapper h2{font-size:16px}}.header-wrapper .heading-wrapper h1{font-size:4rem;text-align:center}@media (min-width:320px) and (max-width:424px){.header-wrapper .heading-wrapper h1{font-size:1.5rem}}@media (min-width:425px) and (max-width:767px){.header-wrapper .heading-wrapper h1{font-size:1.5rem}}@media (min-width:768px) and (max-width:1023px){.header-wrapper .heading-wrapper h1{font-size:2.5rem}}.header-wrapper p{overflow:hidden;text-align:center;width:50%}@media (min-width:320px) and (max-width:424px){.header-wrapper p{font-size:12px;width:100%}}@media (min-width:425px) and (max-width:767px){.header-wrapper p{font-size:12px;width:100%}}@media (min-width:768px) and (max-width:1023px){.header-wrapper p{font-size:14px;width:100%}}.work-wrapper{align-items:center;display:flex;flex-direction:column;margin-top:10vh;width:80vw}.work-wrapper h1{font-size:3rem;line-height:20px}.work-wrapper .grid{grid-gap:10px;display:grid;grid-template-columns:repeat(3,1fr);margin-top:20px}@media (min-width:320px) and (max-width:424px){.work-wrapper .grid{grid-template-columns:1fr}}@media (min-width:425px) and (max-width:767px){.work-wrapper .grid{grid-template-columns:1fr}}@media (min-width:768px) and (max-width:1023px){.work-wrapper .grid{grid-template-columns:1fr 1fr}}.about-section{display:flex;justify-content:space-between;margin-top:10vh;width:80vw}@media (min-width:320px) and (max-width:424px){.about-section{flex-direction:column-reverse}}@media (min-width:425px) and (max-width:767px){.about-section{flex-direction:column-reverse}}@media (min-width:768px) and (max-width:1023px){.about-section{align-items:center;flex-direction:column-reverse}}.about-section .content{width:50%}@media (min-width:320px) and (max-width:424px){.about-section .content{width:100%}}@media (min-width:425px) and (max-width:767px){.about-section .content{width:100%}}@media (min-width:768px) and (max-width:1023px){.about-section .content{width:100%}}.about-section .content h1{font-size:3rem;line-height:20px}@media (min-width:768px) and (max-width:1023px){.about-section .content h1,.about-section .content p{text-align:center}}.about-section .image-wrapper{align-items:top;display:flex;justify-content:center;overflow:hidden;width:50%}@media (min-width:320px) and (max-width:424px){.about-section .image-wrapper{width:100%}}@media (min-width:425px) and (max-width:767px){.about-section .image-wrapper{width:100%}}@media (min-width:768px) and (max-width:1023px){.about-section .image-wrapper{width:100%}}.skills-container{align-items:center;display:flex;flex-direction:column;margin-top:10vh;width:80vw}.skills-container h1{font-size:3rem;line-height:20px}.skills-container .skills-grid{grid-gap:20px;display:grid;grid-template-columns:repeat(3,1fr);margin-top:50px}@media (min-width:320px) and (max-width:424px){.skills-container .skills-grid{grid-template-columns:1fr}}@media (min-width:425px) and (max-width:767px){.skills-container .skills-grid{grid-template-columns:1fr}}@media (min-width:768px) and (max-width:1023px){.skills-container .skills-grid{grid-template-columns:1fr 1fr}}.skills-container .skills-grid .skill{align-items:center;display:flex;flex-direction:column;text-align:center}.skills-container .skills-grid .skill img{height:3rem}.skills-container .skills-grid .skill p{font-size:14px}.skills-container .skills-grid .skill .beginner{color:#3d903d}.skills-container .skills-grid .skill .intermediate{color:#ef6731}.skills-container .skills-grid .skill .advanced{color:darkred}.skills-container .skills-grid .skill .expert{color:purple}.promotion-container{align-items:center;display:flex;flex-direction:column;margin-top:10vh;text-align:center;width:80vw}.promotion-container h1{font-size:3rem;line-height:20px}.footer-container{align-items:center;display:flex;flex-direction:column;margin-bottom:10vh;margin-top:10vh;width:80vw}.footer-container h1{font-size:3rem;line-height:20px}.footer-container h2{font-size:1.5rem;overflow:hidden}@media (min-width:320px) and (max-width:424px){.footer-container h2{display:none}}@media (min-width:425px) and (max-width:767px){.footer-container h2{font-size:14px}}@media (min-width:768px) and (max-width:1023px){.footer-container h2{font-size:1.2rem}}.footer-container .email-link{color:#000;font-size:1.5rem}.footer-container .social-icons{margin-top:20px}.footer-container .social-icons img{height:2rem;margin:10px}.footer-container span{margin-top:10px}.footer-container icon{color:red}html{--bg:#fff;--bg-secondary:#f1f1f1;--headings:#000;--text:#333;--links:blue;--highlight:#ffecb2;--code-text:#9d174d;--share-text:#999}.blog-wrapper{align-items:center;display:flex;flex-direction:column;margin-top:10vh;width:80vw}@media (min-width:320px) and (max-width:424px){.blog-wrapper{width:80%}}@media (min-width:425px) and (max-width:767px){.blog-wrapper{width:80%}}.blog-wrapper h1{font-size:3rem;line-height:20px}.blog-wrapper .btn{background-color:#000;color:#fff;margin-top:5vh;padding:10px 15px;text-align:center;text-decoration:none}.blog-wrapper .heavy{text-transform:uppercase}.blog-post-container{align-items:center;display:flex;flex-direction:column;height:auto;overflow:hidden;width:100vw}@media (min-width:320px) and (max-width:424px){.blog-post-container{width:80%}}@media (min-width:425px) and (max-width:767px){.blog-post-container{width:80%}}.blog-post-container .blog-post{align-items:center;display:flex;flex-direction:column;height:100%;justify-content:center;width:80%}.blog-post-container .blog-post h1{align-items:center}.blog-post-container .blog-post .blog-post-content{display:flex;flex-direction:column;font-family:Inter,-apple-system,avenir next,avenir,roboto,noto,ubuntu,helvetica neue,helvetica,sans-serif;font-size:1rem;line-height:2;margin-top:3vh;max-width:900px;width:80vw}.blog-post-container .blog-post .blog-post-content h1{font-size:3rem;line-height:20px}.post-date{color:#2a2a2a;font-size:.8em;font-weight:700;text-transform:uppercase}.token{font-family:Bitstream Vera Sans Mono,Consolas,Courier,monospace;font-size:.9rem}:not(pre)>code[class*=language-]{background-color:var(--bg-secondary);border-radius:.3em;color:var(--code-text);font-weight:700;padding:.2rem;white-space:normal}.gatsby-highlight-code-line{background-color:#1a1f35;border-left:.25em solid #f99;color:#f2f0ec;display:block;margin-left:-1em;margin-right:-1em;padding-left:.75em;padding-right:1em}.gatsby-highlight{background-color:#1a1f35;border-radius:.3em;color:#f2f0ec;margin:.5em 0;overflow:auto;padding:1em}.gatsby-highlight pre[class*=language-]{background-color:transparent;float:left;margin:0;min-width:100%;overflow:initial;padding:0}.gatsby-highlight pre[class*=language-].line-numbers{padding-left:2.8em}.blog-card{align-items:left;display:flex;flex-direction:column;margin-top:5vh;width:60vw}@media (min-width:320px) and (max-width:424px){.blog-card{width:90%}}@media (min-width:425px) and (max-width:767px){.blog-card{width:90%}}.blog-card .content{cursor:pointer;opacity:1;padding:10px;text-align:left}.blog-card .content h1{color:#0071c2;font-size:24px;line-height:24px}.blog-card .content p{color:#000;font-size:16px;margin-bottom:20px}.blog-card .content .date{color:#2a2a2a;font-size:.8em;font-weight:700;text-transform:uppercase}*{font-family:Inter,-apple-system,avenir next,avenir,roboto,noto,ubuntu,helvetica neue,helvetica,sans-serif}body{margin:0;overflow-x:hidden;overflow-y:scroll;padding:0}.section{height:auto;overflow:hidden;width:100vw}.container{align-items:center;display:flex;flex-direction:column;height:100%;justify-content:center;width:100%}.primary-btn{background-color:#000;border:0;color:#fff;cursor:pointer;font-size:16px;margin:10px;padding:10px 15px;text-decoration:none;text-transform:uppercase;transition:all .2s ease-in-out}.primary-btn:hover{-webkit-transform:scale(1.1);transform:scale(1.1)}</style><title data-react-helmet="true">Building Keras-Dev Docker Container on arm64/aarch64 systems like M1 Macbooks | Anurag Shenoy&#x27;s Blog | Portfolio</title><link rel="icon" href="/favicon-32x32.png?v=4a9773549091c227cd2eb82ccd9c5e3a" type="image/png"/><link rel="manifest" href="/manifest.webmanifest" crossorigin="anonymous"/><link rel="apple-touch-icon" sizes="48x48" href="/icons/icon-48x48.png?v=4a9773549091c227cd2eb82ccd9c5e3a"/><link rel="apple-touch-icon" sizes="72x72" href="/icons/icon-72x72.png?v=4a9773549091c227cd2eb82ccd9c5e3a"/><link rel="apple-touch-icon" sizes="96x96" href="/icons/icon-96x96.png?v=4a9773549091c227cd2eb82ccd9c5e3a"/><link rel="apple-touch-icon" sizes="144x144" href="/icons/icon-144x144.png?v=4a9773549091c227cd2eb82ccd9c5e3a"/><link rel="apple-touch-icon" sizes="192x192" href="/icons/icon-192x192.png?v=4a9773549091c227cd2eb82ccd9c5e3a"/><link rel="apple-touch-icon" sizes="256x256" href="/icons/icon-256x256.png?v=4a9773549091c227cd2eb82ccd9c5e3a"/><link rel="apple-touch-icon" sizes="384x384" href="/icons/icon-384x384.png?v=4a9773549091c227cd2eb82ccd9c5e3a"/><link rel="apple-touch-icon" sizes="512x512" href="/icons/icon-512x512.png?v=4a9773549091c227cd2eb82ccd9c5e3a"/><link as="script" rel="preload" href="/webpack-runtime-b5a1197b4dce08032c07.js"/><link as="script" rel="preload" href="/framework-0841a708e42dbed148bb.js"/><link as="script" rel="preload" href="/app-4025e550f650b75cd59a.js"/><link as="script" rel="preload" href="/commons-9d97cb314d58da02d715.js"/><link as="script" rel="preload" href="/component---src-pages-markdown-remark-frontmatter-slug-js-069fbe32344d374724d4.js"/><link as="fetch" rel="preload" href="/page-data/blog/build-keras-dev-docker-container-m1/page-data.json" crossorigin="anonymous"/><link as="fetch" rel="preload" href="/page-data/sq/d/63159454.json" crossorigin="anonymous"/><link as="fetch" rel="preload" href="/page-data/app-data.json" crossorigin="anonymous"/></head><body><div id="___gatsby"><div style="outline:none" tabindex="-1" id="gatsby-focus-wrapper"><div class="section"><div class="container"><div class="navbar-wrapper"><div role="button" class="name" tabindex="0"><a class="home active" href="/">Portfolio.</a></div><div class="links-wrapper"><a class="link active" href="/work">Work</a><a class="link active" href="/blog">Blog</a><a class="link active" href="/about">About</a><button>Contact</button></div></div></div></div><main><div class="blog-post-container"><script src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML" type="text/javascript"></script><div class="blog-post"><h1>Building Keras-Dev Docker Container on arm64/aarch64 systems like M1 Macbooks</h1><p class="post-date"><span>February 03, 2022</span></p><div class="blog-post-content"><h2>Overview</h2>
<p>I faced several problems yesterday (2nd February, 2022) trying to get my keras-dev container up and running in order to contribute to keras open-source project. I would like to prevent others from ending up wasting their time trying to solve this, so that they can dive right into the interesting stuff -- contributing to keras.</p>
<h2>Problems I faced</h2>
<p>The biggest issue is that <code class="language-text">Bazel</code> couldn't be installed within an <code class="language-text">aarch64</code> docker container.</p>
<p>Another issue was that <code class="language-text">tf-nightly</code> couldn't be installed.</p>
<h2>Keras Dockerfile</h2>
<p>The Dockerfile keras provides you has a Bazel section which looks something like this:</p>
<div class="gatsby-highlight" data-language="dockerfile"><pre class="language-dockerfile"><code class="language-dockerfile"><span class="token comment"># Install Bazel</span>
<span class="token instruction"><span class="token keyword">RUN</span> apt update</span>
<span class="token instruction"><span class="token keyword">RUN</span> apt install curl gnupg -y</span>
<span class="token instruction"><span class="token keyword">RUN</span> curl -fsSL https://bazel.build/bazel-release.pub.gpg | gpg --dearmor > bazel.gpg</span>
<span class="token instruction"><span class="token keyword">RUN</span> mv bazel.gpg /etc/apt/trusted.gpg.d/</span>
<span class="token instruction"><span class="token keyword">RUN</span> echo <span class="token string">"deb [arch=amd64] https://storage.googleapis.com/bazel-apt stable jdk1.8"</span> | tee /etc/apt/sources.list.d/bazel.list</span>
<span class="token instruction"><span class="token keyword">RUN</span> apt update &amp;&amp; apt install bazel -y</span></code></pre></div>
<p>While this works with <code class="language-text">amd64</code> (x86_64) systems, it doesn't work with <code class="language-text">arm64</code> systems as the bazel package repository at <a href="https://storage.googleapis.com/bazel-apt">https://storage.googleapis.com/bazel-apt</a> doesn't have any pre-built binaries for <code class="language-text">arm64/aarch64</code> systems like the M1 macbooks.</p>
<p>Due to this, we get an error like:</p>
<div class="gatsby-highlight" data-language="bash"><pre class="language-bash"><code class="language-bash"> <span class="token operator">=</span><span class="token operator">></span> ERROR <span class="token punctuation">[</span><span class="token number">9</span>/9<span class="token punctuation">]</span> RUN <span class="token function">apt</span> <span class="token function">install</span> bazel -y                                        <span class="token number">0</span>.5s
------
 <span class="token operator">></span> <span class="token punctuation">[</span><span class="token number">9</span>/9<span class="token punctuation">]</span> RUN <span class="token function">apt</span> <span class="token function">install</span> bazel -y:
 <span class="token comment">#12 0.123</span>
 <span class="token comment">#12 0.123 WARNING: apt does not have a stable CLI interface. Use with </span>
 <span class="token comment"># caution in scripts.</span>
 <span class="token comment">#12 0.123</span>
 <span class="token comment">#12 0.128 Reading package lists...</span>
 <span class="token comment">#12 0.381 Building dependency tree...</span>
 <span class="token comment">#12 0.448 Reading state information...</span>
 <span class="token comment">#12 0.493 E: Unable to locate package bazel</span>
------
executor failed running <span class="token punctuation">[</span>/bin/sh -c <span class="token function">apt</span> <span class="token function">install</span> bazel -y<span class="token punctuation">]</span>: <span class="token builtin class-name">exit</span> code: <span class="token number">100</span></code></pre></div>
<p>While looking for the solution, I stumbled upon this issue <a href="https://github.com/bazelbuild/bazel/issues/13925">https://github.com/bazelbuild/bazel/issues/13925</a> which gave me hints as to what I should do.</p>
<p>Github user <a href="https://github.com/keith">@keith</a> mentioned an important point in the thread -- that bazel version 4.2.x is probably the first version to support M1 macs.</p>
<p>And Github user <a href="https://github.com/philwo">@philwo</a> recommended to download the arm64 linux binaries and modify their permissions to allow execution.</p>
<p>Using these tips, I set about trying to make it work.
However, I was still stuck and unable to get the bazel command to work.</p>
<p>So I have decided to share the final solution and explain each step in case a beginner wants to contribute to keras on an <code class="language-text">arm64/aarch</code> system like M1 Macbooks.</p>
<p>The Dockerfile which solves all issues:</p>
<div class="gatsby-highlight" data-language="dockerfile"><pre class="language-dockerfile"><code class="language-dockerfile"><span class="token instruction"><span class="token keyword">FROM</span> python:3.9</span>

<span class="token comment"># https://code.visualstudio.com/docs/remote/containers-advanced#_creating-a-nonroot-user</span>
<span class="token instruction"><span class="token keyword">ARG</span> USERNAME=keras-vscode</span>
<span class="token instruction"><span class="token keyword">ARG</span> USER_UID=1000</span>
<span class="token instruction"><span class="token keyword">ARG</span> USER_GID=<span class="token variable">$USER_UID</span></span>

<span class="token comment"># Create the user</span>
<span class="token instruction"><span class="token keyword">RUN</span> groupadd --gid <span class="token variable">$USER_GID</span> <span class="token variable">$USERNAME</span> <span class="token operator">\</span>
    &amp;&amp; useradd --uid <span class="token variable">$USER_UID</span> --gid <span class="token variable">$USER_GID</span> -m <span class="token variable">$USERNAME</span> <span class="token operator">\</span>
    <span class="token comment">#</span>
    <span class="token comment"># [Optional] Add sudo support. Omit if you don't need to install software after connecting.</span>
    &amp;&amp; apt-get update <span class="token operator">\</span>
    &amp;&amp; apt-get install -y sudo bash <span class="token operator">\</span>
    &amp;&amp; echo <span class="token variable">$USERNAME</span> ALL=\(root\) NOPASSWD:ALL > /etc/sudoers.d/<span class="token variable">$USERNAME</span> <span class="token operator">\</span>
    &amp;&amp; chmod 0440 /etc/sudoers.d/<span class="token variable">$USERNAME</span></span>

<span class="token comment"># Nano (to make my life easier)</span>
<span class="token instruction"><span class="token keyword">RUN</span> sudo apt install nano -y</span>

<span class="token comment"># Install Bazel arm64</span>
<span class="token instruction"><span class="token keyword">RUN</span> sudo apt update</span>
<span class="token instruction"><span class="token keyword">RUN</span> wget https://github.com/bazelbuild/bazel/releases/download/4.2.1/bazel-4.2.1-linux-arm64</span>
<span class="token instruction"><span class="token keyword">RUN</span> sudo mkdir /usr/local/bin/bazel</span>
<span class="token instruction"><span class="token keyword">RUN</span> sudo mv  bazel-4.2.1-linux-arm64 /usr/local/bin/bazel</span>
<span class="token instruction"><span class="token keyword">RUN</span> sudo chmod +x /usr/local/bin/bazel/bazel-4.2.1-linux-arm64</span>
<span class="token instruction"><span class="token keyword">RUN</span> export PATH=<span class="token string">"$PATH:/usr/local/bin/bazel"</span></span>
<span class="token instruction"><span class="token keyword">RUN</span> echo <span class="token string">'export PATH="$PATH:/usr/local/bin/bazel"'</span> >> ~/.bashrc</span>
<span class="token instruction"><span class="token keyword">RUN</span> sudo ln -s /usr/local/bin/bazel/bazel-4.2.1-linux-arm64 /usr/bin/bazel</span>
<span class="token instruction"><span class="token keyword">RUN</span> sudo bazel</span>

<span class="token instruction"><span class="token keyword">USER</span> <span class="token variable">$USERNAME</span></span>
<span class="token instruction"><span class="token keyword">ENV</span> PATH=<span class="token string">"/home/$USERNAME/.local/bin:${PATH}"</span></span></code></pre></div>
<p>The <code class="language-text">wget</code> line downloads the 4.2.1 version of Bazel built for arm64 systems to the present working directory (PWD).</p>
<p>We create the destination folder in the following line and move the downloaded Bazel binary to it.</p>
<p>We then allow the file to be executed by using the <code class="language-text">chmod +x</code> command.</p>
<p>After that, we add the path to our PATH environment variable so that the OS can recognize when we type a command (<code class="language-text">bazel</code>).</p>
<p><code class="language-text">RUN sudo ln -s /usr/local/bin/bazel/bazel-4.2.1-linux-arm64 /usr/bin/bazel</code></p>
<p>In this line, we create a symlink to the binary file from <code class="language-text">/usr/bin/bazel</code>. This tells the OS that whenever we type <code class="language-text">bazel</code> in the command line, we want it to execute the file <code class="language-text">bazel-4.2.1-linux-arm64</code>.</p>
<p>Finally, <code class="language-text">sudo bazel</code> extracts the binary.</p>
<p>Now, the docker container will be built successfully and you will have bazel ready to use.</p>
<p>I have added the above as a Gist here: <a href="https://gist.github.com/shenoy-anurag/e501fbef1ba551b04404a3e173533aa8">https://gist.github.com/shenoy-anurag/e501fbef1ba551b04404a3e173533aa8</a></p>
<h2>Python Requirements</h2>
<p>The next step according to the <a href="https://github.com/keras-team/keras/blob/7857fa00431634ce59585e087d2d694b81669548/CONTRIBUTING.md">Keras contributing guidelines</a> is to install the python requirements.</p>
<p>You will get another error for tf-nightly. This is because tf-nightly doesn't have any <code class="language-text">aarch64</code> wheels.</p>
<p>Instead, install <code class="language-text">tensorflow-aarch64</code> which has wheels built for aarch64, but the latest version as of today is 2.7.0. However, you'll have to make do, unless you build tensorflow from scratch from the latest git repo code.</p>
<p>Mike Chan has a good article on that on medium: <a href="https://medium.com/@m7807031/how-to-install-tensorflow-in-different-os-languane-framework-66b3beaa1b3d">https://medium.com/@m7807031/how-to-install-tensorflow-in-different-os-languane-framework-66b3beaa1b3d</a></p>
<p>We'll go with <a href="https://github.com/KumaTea/tensorflow-aarch64"><code class="language-text">tensorflow-aarch64</code></a></p>
<p>Install using:</p>
<div class="gatsby-highlight" data-language="text"><pre class="language-text"><code class="language-text">pip install tensorflow-aarch64</code></pre></div>
<p>or better yet, replace the line <code class="language-text">tf-nightly</code> in <code class="language-text">requirements.txt</code> with <code class="language-text">tensorflow-aarch64</code>.</p>
<p>and continue with the steps on Keras's contributing guidelines page.</p>
<h2>References</h2>
<ol>
<li>Bazel issue on Github <a href="https://github.com/bazelbuild/bazel/issues/13925">https://github.com/bazelbuild/bazel/issues/13925</a></li>
<li><a href="https://medium.com/@m7807031/how-to-install-tensorflow-in-different-os-languane-framework-66b3beaa1b3d">https://medium.com/@m7807031/how-to-install-tensorflow-in-different-os-languane-framework-66b3beaa1b3d</a></li>
<li>Symbolic Links <a href="https://www.freecodecamp.org/news/symlink-tutorial-in-linux-how-to-create-and-remove-a-symbolic-link/">https://www.freecodecamp.org/news/symlink-tutorial-in-linux-how-to-create-and-remove-a-symbolic-link/</a></li>
<li>Install Bazel Ubuntu (x86/amd64) <a href="https://docs.bazel.build/versions/main/install-ubuntu.html">https://docs.bazel.build/versions/main/install-ubuntu.html</a></li>
</ol></div></div></div></main></div><div id="gatsby-announcer" style="position:absolute;top:0;width:1px;height:1px;padding:0;overflow:hidden;clip:rect(0, 0, 0, 0);white-space:nowrap;border:0" aria-live="assertive" aria-atomic="true"></div></div><script id="gatsby-script-loader">/*<![CDATA[*/window.pagePath="/blog/build-keras-dev-docker-container-m1/";window.___webpackCompilationHash="081552d3c4ef2a6addac";/*]]>*/</script><script id="gatsby-chunk-mapping">/*<![CDATA[*/window.___chunkMapping={"polyfill":["/polyfill-65ceb1e975d78bd881ff.js"],"app":["/app-4025e550f650b75cd59a.js"],"component---src-pages-404-js":["/component---src-pages-404-js-6f7c02045c8a298582d1.js"],"component---src-pages-about-js":["/component---src-pages-about-js-3a791f9dd0d2fec8d001.js"],"component---src-pages-blog-js":["/component---src-pages-blog-js-7a39da1ff7a6a2d1f249.js"],"component---src-pages-index-js":["/component---src-pages-index-js-be5308d0d420bec004e6.js"],"component---src-pages-markdown-remark-frontmatter-slug-js":["/component---src-pages-markdown-remark-frontmatter-slug-js-069fbe32344d374724d4.js"],"component---src-pages-work-js":["/component---src-pages-work-js-036aecaa9ea7f1758396.js"]};/*]]>*/</script><script src="/polyfill-65ceb1e975d78bd881ff.js" nomodule=""></script><script src="/component---src-pages-markdown-remark-frontmatter-slug-js-069fbe32344d374724d4.js" async=""></script><script src="/commons-9d97cb314d58da02d715.js" async=""></script><script src="/app-4025e550f650b75cd59a.js" async=""></script><script src="/framework-0841a708e42dbed148bb.js" async=""></script><script src="/webpack-runtime-b5a1197b4dce08032c07.js" async=""></script></body></html>